# Pre-Market Scanner Configuration
# PS60 Trading System

scan_config:
  # Scan timing configuration
  schedule:
    pre_market: "08:00"  # Pre-market scan time (ET)
    intraday: "10:00"    # Optional intraday update (ET)
    enabled: true        # Enable automatic scheduling
    timezone: "US/Eastern"

  # Stock universe configuration
  universe:
    # Default indexes to scan
    indexes:
      - "NASDAQ100"
      - "SP500"

    # Filtering criteria
    min_price: 5.0              # Minimum stock price
    min_volume: 200000          # Minimum average daily volume
    max_symbols: 100            # Max symbols per scan (IBKR limit)

    # Custom symbols to always include
    custom_symbols: []

    # Sectors to exclude (optional)
    exclude_sectors: []

  # PS60 Filter thresholds
  filters:
    gap_threshold: 2.0          # Minimum gap percentage
    rvol_threshold: 2.0         # Minimum relative volume
    room_to_run_pct: 1.0        # Minimum % to next resistance

    # Pattern detection
    enable_pattern_detection: true
    consolidation_days: 5       # Days to check for base patterns

    # News catalyst weighting
    news_weight: 1.5            # Multiplier for stocks with news

  # Technical indicators configuration
  indicators:
    # Moving averages to calculate
    sma_periods: [5, 10, 20, 50, 100, 200]

    # Bollinger Bands
    bollinger_period: 20
    bollinger_std: 2

    # Linear regression (60-min chart)
    regression_period: 30

    # Volume analysis
    volume_lookback_days: 20    # Days for average volume calculation

  # IBKR Web API connection settings
  ibkr:
    # Client Portal Gateway URL
    web_api_url: "https://localhost:5000/v1/api"

    # TWS API settings (legacy - kept for reference)
    host: "127.0.0.1"
    port: 7497                  # 7497 for paper, 7496 for live
    client_id: 1
    timeout: 30                 # Connection timeout in seconds

    # Data request limits
    max_concurrent_requests: 50
    request_delay: 0.1          # Delay between requests (seconds)
    retry_count: 3              # Number of retries for failed requests
    retry_delay: 1.0            # Base delay for retries (seconds)
    max_requests_per_second: 10 # Rate limit for API calls

    # Market data settings
    market_data_type: 1         # 1=Live, 2=Frozen, 3=Delayed, 4=Delayed-Frozen

    # Web API specific settings
    use_web_api: false          # Use TWS API instead of Web API
    gateway_path: ""            # Path to Client Portal Gateway (if auto-start needed)

  # News integration settings
  news:
    enabled: true
    providers:
      - "IBKR"                  # Primary: IBKR news feed

    # Keywords to flag as important
    catalyst_keywords:
      - "earnings"
      - "FDA"
      - "merger"
      - "acquisition"
      - "upgrade"
      - "downgrade"
      - "guidance"

  # Output configuration
  output:
    # File paths
    watchlist_path: "./output/watchlist.csv"
    research_log: "./output/research.md"
    json_output: "./output/scan_results.json"

    # Output formats to generate
    formats: ["csv", "json", "markdown"]

    # Watchlist size limits
    max_long_candidates: 10
    max_short_candidates: 10

    # Include debugging info
    verbose: true

  # Historical data settings (for backtesting)
  historical:
    days_back: 30               # Days of historical data to fetch
    bar_size: "1 day"           # For daily bars
    intraday_bar_size: "1 hour" # For 60-minute bars

  # Risk management
  risk:
    max_position_size: 1000     # Max shares per position
    max_risk_per_trade: 0.02    # 2% max risk per trade
    min_reward_risk_ratio: 1.0  # Minimum 1:1 R:R

  # Logging configuration
  logging:
    level: "INFO"               # DEBUG, INFO, WARNING, ERROR
    log_file: "./logs/scanner.log"
    max_file_size: "10MB"
    backup_count: 5

# Market session times (ET)
market_sessions:
  pre_market:
    start: "04:00"
    end: "09:30"
  regular:
    start: "09:30"
    end: "16:00"
  after_hours:
    start: "16:00"
    end: "20:00"